import{A as m,B as w,m as a,n as $,p as S,r as l,s as y,u as n,v as k,x as g,y as p,z as c}from"./chunk-EM5XZP4M.js";import{Pa as r,S as u,Y as f}from"./chunk-O2BEBOXS.js";import{e as o}from"./chunk-ACKELEN3.js";var v="ahorros",b=class d{_firestore=f(S);_collectionRef=y(this._firestore,v);_utils=f($);savings$=r([]);loading$=r(!1);mockSavings$=r(w.Savings);getSavings(i=1){if(this.loading$.set(!0),a.mockUp)switch(setTimeout(()=>{this.loading$.set(!1)},2e3),i){case 0:return this.mockSavings$;case 1:return r(this.mockSavings$().filter(s=>s.activo));case 2:return r(this.mockSavings$().filter(s=>!s.activo))}let t,e;switch(i){case 0:t=l(this._collectionRef,{idField:"id"});break;case 1:e=g(this._collectionRef,m("activo","==",!0)),t=l(e,{idField:"id"});break;case 2:e=g(this._collectionRef,m("activo","==",!1)),t=l(e,{idField:"id"});break}return t.subscribe({next:s=>{this.savings$.set(s),this.loading$.set(!1)},error:s=>{this.loading$.set(!1),console.error("Error al obtener la colecci\xF3n "+v+": ",s)}}),this.savings$}getSaving(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp)return yield this._utils.delay(1),this.loading$.set(!1),this.mockSavings$().find(t=>t.id===i);try{return(yield k(n(this._firestore,v,i))).data()}catch(t){throw t}finally{this.loading$.set(!1)}})}addSaving(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1),i.id=this._utils.generateId(),this.mockSavings$.set(this.mockSavings$().concat(i)),this.loading$.set(!1);return}try{yield p(n(this._collectionRef),i)}catch(t){throw t}finally{this.loading$.set(!1)}})}updateSaving(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let t=this.mockSavings$().findIndex(s=>s.id===i.id),e=this.mockSavings$();e[t]=i,this.mockSavings$.set(e),this.loading$.set(!1);return}try{yield c(n(this._collectionRef,i.id),{nombre:i.nombre,menta:i.meta})}catch(t){throw t}finally{this.loading$.set(!1)}})}save(i,t){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let e=this.mockSavings$().findIndex(h=>h.id===i.id),s=this.mockSavings$();s[e].cantidad+=t,this.mockSavings$.set(s),this.loading$.set(!1);return}try{yield c(n(this._collectionRef,i.id),{cantidad:i.cantidad+t})}catch(e){throw e}finally{this.loading$.set(!1)}})}withdraw(i,t){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let e=this.mockSavings$().findIndex(h=>h.id===i.id),s=this.mockSavings$();s[e].cantidad-=t,this.mockSavings$.set(s),this.loading$.set(!1);return}try{yield c(n(this._collectionRef,i.id),{cantidad:i.cantidad-t})}catch(e){throw e}finally{this.loading$.set(!1)}})}deleteSaving(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let t=this.mockSavings$().findIndex(s=>s.id===i),e=this.mockSavings$();e[t].activo=!1,this.mockSavings$.set(e),this.loading$.set(!1);return}try{yield c(n(this._collectionRef,i),{activo:!1})}catch(t){throw t}finally{this.loading$.set(!1)}})}static \u0275fac=function(t){return new(t||d)};static \u0275prov=u({token:d,factory:d.\u0275fac,providedIn:"root"})};export{b as a};
