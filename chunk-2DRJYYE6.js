import{B as w,m as a,n as h,p as y,r as $,s as u,t as F,u as e,v as g,y as m,z as k}from"./chunk-EM5XZP4M.js";import{Pa as r,S as f,Y as c}from"./chunk-O2BEBOXS.js";import{e as o}from"./chunk-ACKELEN3.js";var d="familiares",_=class l{_firestore=c(y);_collectionRef=u(this._firestore,d);_utils=c(h);family$=r([]);loading$=r(!1);mockFamifly$=r(w.Family);getFamilyList(){return this.loading$.set(!0),a.mockUp?(setTimeout(()=>{this.loading$.set(!1)},2e3),this.mockFamifly$):($(this._collectionRef,{idField:"id"}).subscribe({next:t=>{this.family$.set(t),this.loading$.set(!1)},error:t=>{this.loading$.set(!1),console.error("Error al obtener la colecci\xF3n "+d+": ",t)}}),this.family$)}getFamily(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp)return yield this._utils.delay(1),this.loading$.set(!1),this.mockFamifly$().find(t=>t.id===i);try{return(yield g(e(this._firestore,d,i))).data()}catch(t){throw t}finally{this.loading$.set(!1)}})}addFamily(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1),i.id||(i.id=this._utils.generateId()),this.mockFamifly$.set(this.mockFamifly$().concat(i)),this.loading$.set(!1);return}try{if(i.id){let t=i.id;delete i.id,yield m(e(this._collectionRef,t),i)}else yield m(e(this._collectionRef),i)}catch(t){throw t}finally{this.loading$.set(!1)}})}updateFamily(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let t=this.mockFamifly$().findIndex(n=>n.id===i.id),s=this.mockFamifly$();s[t]=i,this.mockFamifly$.set(s),this.loading$.set(!1);return}try{yield k(e(this._collectionRef,i.id),{nombres:i.nombres,apellidos:i.apellidos,admin:i.admin,foto:i.foto})}catch(t){throw t}finally{this.loading$.set(!1)}})}deleteFamily(i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);try{let t=this.mockFamifly$().findIndex(n=>n.id===i),s=this.mockFamifly$();s.splice(t,1),this.mockFamifly$.set(s);return}catch(t){throw t}finally{this.loading$.set(!1)}}try{yield F(e(this._collectionRef,i))}catch(t){throw t}finally{this.loading$.set(!1)}})}static \u0275fac=function(t){return new(t||l)};static \u0275prov=f({token:l,factory:l.\u0275fac,providedIn:"root"})};export{_ as a};
