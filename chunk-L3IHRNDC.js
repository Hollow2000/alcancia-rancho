import{k as p}from"./chunk-3WJ5JSSG.js";import{c as $,e as r,f as S,h as c,j as m,k,l as g,m as f}from"./chunk-F3QCDJXU.js";import{J as a,K as u}from"./chunk-5CKZWRBR.js";import{Pa as n,S as v,Y as h}from"./chunk-O2BEBOXS.js";import{e as o}from"./chunk-ACKELEN3.js";var b="ahorros",y=class l{_firestore=h($);_collectionRef=S(this._firestore,b);_utils=h(u);savings$=n([]);loading$=n(!1);mockSavings$=n(p.Savings);getSavings(t=1){if(this.loading$.set(!0),a.mockUp)switch(setTimeout(()=>{this.loading$.set(!1)},2e3),t){case 0:return this.mockSavings$;case 1:return n(this.mockSavings$().filter(e=>e.activo));case 2:return n(this.mockSavings$().filter(e=>!e.activo))}let i,s;switch(t){case 0:i=r(this._collectionRef,{idField:"id"});break;case 1:s=m(this._collectionRef,f("activo","==",!0)),i=r(s,{idField:"id"});break;case 2:s=m(this._collectionRef,f("activo","==",!1)),i=r(s,{idField:"id"});break}return i.subscribe({next:e=>{this.savings$.set(e),this.loading$.set(!1)},error:e=>{this.loading$.set(!1),console.error("Error al obtener la colecci\xF3n "+b+": ",e)}}),this.savings$}addSaving(t){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1),t.id=this._utils.generateId(),this.mockSavings$.set(this.mockSavings$().concat(t)),this.loading$.set(!1);return}yield k(c(this._collectionRef),t).then(i=>(this.loading$.set(!1),i)).catch(i=>{throw this.loading$.set(!1),i})})}updateSaving(t){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let i=this.mockSavings$().findIndex(e=>e.id===t.id),s=this.mockSavings$();s[i]=t,this.mockSavings$.set(s),this.loading$.set(!1);return}yield g(c(this._collectionRef,t.id),{nombre:t.nombre,menta:t.meta}).then(i=>(this.loading$.set(!1),i)).catch(i=>{throw this.loading$.set(!1),i})})}save(t,i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let s=this.mockSavings$().findIndex(d=>d.id===t),e=this.mockSavings$();e[s].cantidad+=i,this.mockSavings$.set(e),this.loading$.set(!1);return}})}withdraw(t,i){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let s=this.mockSavings$().findIndex(d=>d.id===t),e=this.mockSavings$();e[s].cantidad-=i,this.mockSavings$.set(e),this.loading$.set(!1);return}})}deleteSaving(t){return o(this,null,function*(){if(this.loading$.set(!0),a.mockUp){yield this._utils.delay(1);let i=this.mockSavings$().findIndex(e=>e.id===t),s=this.mockSavings$();s[i].activo=!1,this.mockSavings$.set(s),this.loading$.set(!1);return}yield g(c(this._collectionRef,t),{activo:!1}).then(i=>(this.loading$.set(!1),i)).catch(i=>{throw this.loading$.set(!1),i})})}static \u0275fac=function(i){return new(i||l)};static \u0275prov=v({token:l,factory:l.\u0275fac,providedIn:"root"})};export{y as a};
