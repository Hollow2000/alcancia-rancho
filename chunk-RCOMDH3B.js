import{k as g}from"./chunk-3WJ5JSSG.js";import{c as f,e as h,f as y,g as $,h as l,k as u,l as F}from"./chunk-F3QCDJXU.js";import{J as s,K as d}from"./chunk-5CKZWRBR.js";import{Pa as o,S as m,Y as c}from"./chunk-O2BEBOXS.js";import{e as a}from"./chunk-ACKELEN3.js";var k="familiares",b=class r{_firestore=c(f);_collectionRef=y(this._firestore,k);_utils=c(d);family$=o([]);loading$=o(!1);mockFamifly$=o(g.Family);getFamilyList(){return this.loading$.set(!0),s.mockUp?(setTimeout(()=>{this.loading$.set(!1)},2e3),this.mockFamifly$):(h(this._collectionRef,{idField:"id"}).subscribe({next:i=>{this.family$.set(i),this.loading$.set(!1)},error:i=>{this.loading$.set(!1),console.error("Error al obtener la colecci\xF3n "+k+": ",i)}}),this.family$)}addFamily(t){return a(this,null,function*(){if(this.loading$.set(!0),s.mockUp){yield this._utils.delay(1),t.id=this._utils.generateId(),this.mockFamifly$.set(this.mockFamifly$().concat(t)),this.loading$.set(!1);return}yield u(l(this._collectionRef),t).then(i=>(this.loading$.set(!1),i)).catch(i=>{throw this.loading$.set(!1),i})})}updateFamily(t){return a(this,null,function*(){if(this.loading$.set(!0),s.mockUp){yield this._utils.delay(1);let i=this.mockFamifly$().findIndex(n=>n.id===t.id),e=this.mockFamifly$();e[i]=t,this.mockFamifly$.set(e),this.loading$.set(!1);return}yield F(l(this._collectionRef,t.id),{nombres:t.nombres,apellidos:t.apellidos,admin:t.admin,foto:t.foto}).then(i=>(this.loading$.set(!1),i)).catch(i=>{throw this.loading$.set(!1),i})})}deleteFamily(t){return a(this,null,function*(){if(this.loading$.set(!0),s.mockUp){yield this._utils.delay(1);try{let i=this.mockFamifly$().findIndex(n=>n.id===t),e=this.mockFamifly$();e.splice(i,1),this.mockFamifly$.set(e),this.loading$.set(!1);return}catch(i){throw this.loading$.set(!1),i}}yield $(l(this._collectionRef,t)).then(i=>(this.loading$.set(!1),i)).catch(i=>{throw this.loading$.set(!1),i})})}static \u0275fac=function(i){return new(i||r)};static \u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"})};export{b as a};
